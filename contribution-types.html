<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="data/keys.js"></script>
    <script src="scripts/util.js"></script>
    <link rel="stylesheet" href="styles/settings.css" />
    <link rel="stylesheet" href="styles/base.css" />
    <link rel="stylesheet" href="styles/generic.css" />
    <link rel="stylesheet" href="styles/objects.css" />
    <link rel="stylesheet" href="styles/components.css" />
    <link rel="stylesheet" href="styles/vis06-08-styles.css" />
    <link rel="stylesheet" href="styles/vis10.css" />

    <title>Trabalho de InfoViz</title>
  </head>
  <body>
    <header>
      <div class="header__top">
        <div class="header__logo">
          <h3 class="header__title">HInt within the HCI scope - Definition, State-of-the-Art and Challenges</h3>
          <p class="header__subtitle">A Visual Survey of Human-Computer Integration (HInt) in the HCI view point</p>
          <p class="header__authors">By Glívia A. R. Barbosa, Elizabeth D. S. da Costa, Felipe S. A. de Freitas and Eduardo H. R. da Silva</p>
        </div>
        <div class="header__left-side">
          <ul class="header__left-side__menu">
            <li class="header__left-side__menu__item">
              <a href="/">Home</a>
            </li>
            <li class="header__left-side__menu__item header__left-side__menu__item--active">
              <a href="/intitutions-and-authors.html">Publications</a>
            </li>
            <li class="header__left-side__menu__item">
              <a href="/challenges.html">HInt Challenges</a>
            </li>
          </ul>
        </div>
      </div>
      <div class="header__submenu">
        <ul class="header__submenu__list">
          <li class="header__submenu__list__item">
            <a href="/intitutions-and-authors.html">Institutions and Authors</a>
          </li>
          <li class="header__submenu__list__item">
            <a href="/collaboration-networks.html">Collaboration Network</a>
          </li>
          <li class="header__submenu__list__item">
            <a href="/focus-contributions.html">Focus</a>
          </li>
          <li class="header__submenu__list__item header__submenu__list__item--active">
            <a href="/contribution-types.html">Contribution Types</a>
          </li>
          <li class="header__submenu__list__item">
            <a href="/reference-list.html">References</a>
          </li>
        </ul>
      </div>
    </header>
    <main>

      <div class="container">
      <div class="card__body__challenge__group">
        <!-- <section class="stats">
          <div class="stats__stat stats__stat--light-cornflower-blue tooltip" data-tooltip="A Survey of Incorporating Affective Computing for Human-System Co-adaptation&#013;&#010;Augmented Human and Human-Machine Co-evolution: Efficiency and Ethics&#013;&#010;Beyond Confluence, Integration and Symbiosis: Creating More Aware Relationships in Smart Cities&#013;&#010;Body-Borne Computers as Extensions of Self&#013;&#010;Co-riding With My eBike to Get Green Lights&#013;&#010;Computer as Partner: A Critique Perspective of Interaction Design for Social Sustainability&#013;&#010;Designing human-in-the-loop autonomous Cyber-Physical Systems&#013;&#010;Embracing Companion Technologies&#013;&#010;Engineering human-in-the-loop interactions in cyber-physical systems&#013;&#010;Human augmentation: Past, present and future&#013;&#010;Human-computer integration&#013;&#010;Human-Computer Integration (Dagstuhl Seminar 18322)&#013;&#010;Human-Engaged Computing: the future of Human–Computer Interaction&#013;&#010;'I had super-powers when eBike riding' Towards Understanding the Design of Integrated Exertion&#013;&#010;Introducing Peripheral Awareness as a Neurological State for Human-computer Integration&#013;&#010;Manifesting the Cyborg through Techno-Body Modification: From Human-Computer Interaction to Integration&#013;&#010;Next Steps for Human-Computer Integration&#013;&#010;Seven HCI Grand Challenges&#013;&#010;The future's hybrid nature&#013;&#010;The Guts Game: Towards Designing Ingestible Games">
            <div class="stats__stat__title">SLR Analyzed Publications</div>
            <div class="stats__stat__value">
              <span class="stats__stat__value__numeric">20</span>
            </div>
          </div>
        </section> -->

        <section class="card">
          <div class="card__header">
            <h2>Publication per contribution type</h2>
          </div>
          <div class="card__body">
            <div class="card__body__contribuition-types">
              <div class="card__body__challenge__legend text-legend text-legend">
             
                  <strong  style="padding-right:0.5em;">Order publication by:</strong>
                  <input type="radio" id="citation" name="order" style="padding-left:0.5em;" value="citation" onclick="update('citation')" />
                  <label for="citation" onclick="update('citation')" style="padding-left:0.2em; padding-right:0.5em;">Citation</label>
    
                  <input type="radio" id="focus" name="order" value="focus" onclick="update('focus')" />
                  <label for="focus" onclick="update('focus')"  style="padding-left:0.2em; padding-right:0.5em;">Focus</label>
    
                  <input type="radio" id="year" name="order" value="year" onclick="update('year')" checked="checked" />
                  <label for="year" onclick="update('year')" style="padding-left:0.2em;">Year</label>
               
              </div>
              <div id="focus_legend"></div>
              <div class="tooltip-data"></div>
            </div>
           
          </div>
        </section>
        <div class="stats-and-pie-charts margin-5">
          <section class="stats stats-in-column">
            <div
              class="stats__stat stats__stat--light-cornflower-blue tooltip tooltip-right"
              data-tooltip="A Survey of Incorporating Affective Computing for Human-System Co-adaptation&#013;&#010;Augmented Human and Human-Machine Co-evolution: Efficiency and Ethics&#013;&#010;Beyond Confluence, Integration and Symbiosis: Creating More Aware Relationships in Smart Cities&#013;&#010;Body-Borne Computers as Extensions of Self&#013;&#010;Co-riding With My eBike to Get Green Lights&#013;&#010;Computer as Partner: A Critique Perspective of Interaction Design for Social Sustainability&#013;&#010;Designing human-in-the-loop autonomous Cyber-Physical Systems&#013;&#010;Embracing Companion Technologies&#013;&#010;Engineering human-in-the-loop interactions in cyber-physical systems&#013;&#010;Human augmentation: Past, present and future&#013;&#010;Human-computer integration&#013;&#010;Human-Computer Integration (Dagstuhl Seminar 18322)&#013;&#010;Human-Engaged Computing: the future of Human–Computer Interaction&#013;&#010;'I had super-powers when eBike riding' Towards Understanding the Design of Integrated Exertion&#013;&#010;Introducing Peripheral Awareness as a Neurological State for Human-computer Integration&#013;&#010;Manifesting the Cyborg through Techno-Body Modification: From Human-Computer Interaction to Integration&#013;&#010;Next Steps for Human-Computer Integration&#013;&#010;Seven HCI Grand Challenges&#013;&#010;The future's hybrid nature&#013;&#010;The Guts Game: Towards Designing Ingestible Games"
            >
              <div class="stats__stat__title">SLR Analyzed Publications</div>
              <div class="stats__stat__value">
                <span class="stats__stat__value__numeric">20</span>
              </div>
            </div>
          </section>
          <section class="card">
            <div class="card__header">
              <h2>Focus of Publications</h2>
            </div>
            <div class="card__body card__body--no-overflow">
              <div class="card__body__focus-of-publications__pie-graph"></div>
            </div>
          </section>
        </div>
      </div>
    </div>
    </main>

    <script type="text/javascript">
      const widthPie = 500,
        heightPie = 500;
    </script>
    <script src="d3-scripts/vis11-v6.js"></script>

    <script>

      
      // set the dimensions and margins of the graph
      var margin = { top: 10, right: 100, bottom: 180, left: 200 },
        width = 920 - margin.left - margin.right,
        height = 600 - margin.top - margin.bottom;

      // Initialize plot
      update('year');

      function update(orderBy) {
        d3.select('#my_dataviz').remove();
        d3.selectAll('#focus_legend').remove();

        //legend: append the svg object to the body of the page
        var svg_legend = d3
          .select('.card__body__contribuition-types')
          .append('div')
          .attr('id', 'focus_legend')
          .append('svg')
          .attr('width', width + margin.left + margin.right)
          .attr('height', 70)
          .append('g')
          .attr('transform', 'translate(' + 0 + ',' + 0 + ')');
          // usar o html para nao precisar remover os elementos  ao ordernar

        //graph: append the svg object to the body of the page
        var svg = d3
          .select('.card__body__contribuition-types')
          .append('div')
          .attr('id', 'my_dataviz')
          .append('svg')
          .attr('width', width + margin.left + margin.right)
          .attr('height', height + margin.top + margin.bottom)
          .append('g')
          .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');

        // Initialize the X axis
        var x = d3.scaleBand().range([0, width]).padding(0.2);

        var xAxis = svg
          .append('g')
          .attr('class', 'myXaxis text-axis')
          .attr('transform', 'translate(0,' + height + ')');

        // Initialize the Y axis
        var y = d3.scaleBand().range([height, 0]).padding(0.6);

        var yAxis = svg.append('g').attr('class', 'myYaxis text-axis');

        // Color scale: give me a focus, I return a color
        var color = d3
          .scaleOrdinal()
          .domain(key_focus.map((d) => d.key))
          .range(d3.schemeSet2);
       
        var focus = d3
          .scaleOrdinal()
          .domain(key_focus.map((d) => d.key))
          .range(key_focus.map((d) => d.order));

        //Read the data
        var url = 'data/data_contribution-types.json';

        d3.json(url)
          .then(function (file) {
            //get data relation citation x contribution
            data = file.data;
            //get papers info
            papers = file.papers;

            //sort data by year
            var sortedData = data.slice().sort((a, b) => d3.ascending(a.year, b.year) || d3.descending(a.citation, b.citation));
            var mouseYSpace = 80;
            var limitHeight = 50;

            //sort data by citation
            if (orderBy === 'citation') {
              sortedData = data.slice().sort((a, b) => d3.descending(a.citation, b.citation) || d3.ascending(a.year, b.year));
              mouseYSpace = 150;
              limitHeight = 60;
            } else if (orderBy === 'focus') {
              //sort data by focus
              sortedData = data.slice().sort((a, b) => d3.descending(focus(a.focus), focus(b.focus)));
              mouseYSpace = 90;
              limitHeight = 50;
            }

                
//---------------------------------------------------------------------------------------------------------------------
// Contribution label - Axis X axis
//---------------------------------------------------------------------------------------------------------------------
          // Add X axis
          x.domain(key_contribution.map((d) => d.key));
            xAxis.call(d3.axisBottom(x).tickSize(0))
            .selectAll("text")
              .attr("dy", "1.2em")
              .attr("class", d => "axisX-" + d)
              .style("cursor", "default")  
              
          var labelAxisX = svg.append('g')
            .selectAll('text')
            .data(key_contribution)
            .enter()
            .append('text')
              .attr("class", function(d) { return "text-legend label-" + d.key })
              .attr("y",  height + 20)
              .attr("text-anchor","middle")
              .style("cursor", "default")  
              .attr("fill", "var(--gray)")

          key_contribution.forEach( function (d,i){

            textElement = d3.selectAll(".label-" + d.key)
            tspan = breakText(d.name, x.bandwidth()/5)
      
            for(j in tspan){
              textElement.append("tspan")
              .text(tspan[j])
              .attr("dy","1.3em")
              .attr("x", x(d.key)+58)
    
            }

          })

            // Add X axis title
            svg
              .append('text')
              .attr('text-anchor', 'end')
              .attr('x', width / 2 - 80)
              .attr('y', height + 110)
              .attr('text-anchor', 'left')
              .text('Contribution types');

            // link
            svg
              .append('text')
              .attr('text-anchor', 'end')
              .attr('x', width / 2 - 80)
              .attr('y', height + 110)
              .attr('text-anchor', 'left')
              .text('Contribution types');
            
             svg
              .append("svg:a").attr("xlink:href", "reference-list.html")
              .append("svg:text")
              .text("Click to see the reference list of publications")
              .attr("class","text-legend")
              .style("text-decoration","underline")
              .attr("fill","#0000EE")
              .attr("y", height + margin.bottom-20)
              .attr("x", -margin.left+40)
              .attr("text-anchor", "begin");

//---------------------------------------------------------------------------------------------------------------------
// PUBLICATION label - Axis Y 
//---------------------------------------------------------------------------------------------------------------------

            // Add Y axis
            y.domain(sortedData.map((d) => d.citation));

            yAxis.call(d3.axisLeft(y).tickSize(0))
            .selectAll("text")
              .attr("dx", "-0.5em")
              .attr("class", function(d){ 
                const foundPublication = papers.find((element) => element.citation === d);
                
                return "myArea axisY-" + className(d) + " " + foundPublication.focus}
              )
              .style("cursor", "default")
              .on("mouseover",function(e,d){ 
               
                d3.select(this)
                  .attr('font-weight', 'bold');

                d3.selectAll("." + className(d))
                  .style("fill", function(d){
                     return d3.rgb(color(d.focus)).darker(0.5)})  
              })
              .on("mouseout",function(e,d){ 
                  d3.select(this)
                  .attr('font-weight', 'normal');

                  d3.selectAll("." + className(d))
                    .style("fill", function(d){
                      return d3.rgb(color(d.focus)).darker(0.0)})  
              })
             


            // Y axis title:
            svg
              .append('text')
              .attr('text-anchor', 'end')
              .attr('transform', 'rotate(-90)')
              .attr('y', -margin.left + 20)
              .attr('x', -height / 2 + 50)
              .text('Publication')
              .style("cursor", "default");


//---------------------------------------------------------------------------------------------------------------------
// GRAPH 
//---------------------------------------------------------------------------------------------------------------------

            // variable u: map data to existing rect
            var u = svg.selectAll('rect').data(sortedData, function (d) {
              return d.contribution + ':' + d.citation;
            });

            u.enter()
              .append('rect')
              .merge(u)
              .attr('class', function (d) {
                return 'myArea ' + d.focus + ' ' + className(d.citation);
              })
              .attr('x', function (d) {
                return x(d.contribution);
              })
              .attr('y', function (d) {
                return y(d.citation);
              })
              .attr('width', x.bandwidth())
              .attr('height', y.bandwidth())
              .attr('rx', 4)
              .attr('ry', 4)
              .style('fill', function (d) {
                return color(d.focus);
              })
              .on('mouseover', function (e, d) {
              
                //change rect color
                d3.select(this)
                  .style('fill', function (d) {
                    return d3.rgb(color(d.focus)).darker(0.5);
                  })
                  .transition() // adds animation
                  .duration(100)
                  .attr('y', function (d) {
                    return y(d.citation) - 3;
                  })
                  .attr('height', y.bandwidth() + 6);

                //Get Focus and Contribution description
                const foundContribution = key_contribution.find((element) => element.key == d.contribution);
                const foundFocus = key_focus.find((element) => element.key == d.focus);
                const foundPublication = papers.find((element) => element.id === d.id);

                authors = '<strong>Authors: </strong>';

                if (foundPublication.qt_author === 1) {
                  authors = '<strong>Author: </strong>';
                }

                authors += foundPublication.citation_order;

                d3.select('.tooltip-data')
                  .style('visibility', 'visible')
                  .style('top', function () {
                    return (e.pageY < height + limitHeight ? e.pageY + 10 : e.pageY - mouseYSpace) + 'px';
                  })
                  .style('max-width', '350px')
                  .style('max-width', '500px')
                  .style('left', e.pageX + 10 + 'px')
                  .html(
                    `  <div style="border-left: 4px solid; border-color:${color(foundFocus.key)}; padding: 5px;">
                        <strong>Publication title: </strong> ${foundPublication.title}
                          <div style="margin-top: 2px;">
                            <strong>Focus: </strong> HInt ${foundFocus.name} ( ${foundFocus.key})
                          </div>
                          <div style="margin-top: 2px;">
                            <strong>Contribution: </strong>${foundContribution.name} (${foundContribution.key}) 
                          </div>
                          <div style="margin-top: 2px;">
                            <strong>Event/Forum: </strong> ${foundPublication.event}
                          </div>
                          <div style="margin-top: 2px;">
                            ${authors}
                          </div>
                        </div>
                     `
                  );

                  //highlight publication on Y axis

                  //axisY bold
                  d3.select('.axisY-' + className(d.citation)).attr('font-weight', 'bold');

                  //axisX bold
                  d3.select('.axisX-' + d.contribution).attr('font-weight', 'bold');

              })
              .on('mouseleave', function (e, d) {
                d3.select('.tooltip-data').style('visibility', 'hidden');

                d3.select(this)
                  .style('stroke', 'none')
                  .style('fill', function (d) {
                    return color(d.focus);
                  })
                  .transition() // adds animation
                  .duration(100)
                  .attr('height', y.bandwidth())
                  .attr('y', function (d) {
                    return y(d.citation);
                  });

                  //no highlight publication on Y axis

                  //axisY normal
                  d3.select('.axisY-' + className(d.citation)).attr('font-weight', 'normal');

                  //axisX normal
                  d3.select('.axisX-' + d.contribution).attr('font-weight', 'normal');

              });
          })
          .catch((err) => console.log(err)); //end d3.json reading

        /****************************************** HIGHLIGHT ***************************************/

        // What to do when one group is hovered
        var highlight = function (e, d) {
          //set font label to bold
          d3.selectAll('.label-' + d.key).attr('font-weight', 'bold');

          d3.select('.label-rect' + d.key).style('fill', function (d) {
            return d3.rgb(color(d.key)).darker(0.5);
          });
          // reduce opacity of all groups
          d3.selectAll('.myArea').style('opacity', 0.05);
          // expect the one that is hovered
          d3.selectAll('.' + d.key).style('opacity', 1);
        };

        // And when it is not hovered anymore
        var noHighlight = function (e, d) {
          //set font label to normal
          d3.selectAll('.label-' + d.key).attr('font-weight', 'normal');

          d3.select('.label-rect' + d.key).style('fill', function (d) {
            return color(d.key);
          });

          d3.selectAll('.myArea').style('opacity', 1);
        };

        /****************************************** LEGEND  *****************************************/

        // Add one dot in the legend for each name.
        var size = 20;
        var xAlign = 0;
        var yAlign = 40;

        svg_legend
          .append('text')
          .text('Publication focus on HInt:')
          .attr('class', 'text-legend')
          .attr('x', xAlign)
          .attr('y', yAlign - 20) // 100 is where the first dot appears. 25 is the distance between dots
          .attr('text-anchor', 'left')
          .attr('font-weight', 'bold')
          .attr('cursor', 'default')
          .style('alignment-baseline', 'middle');

        svg_legend
          .selectAll('myrect')
          .data(key_focus)
          .enter()
          .append('rect')
          .attr('class', function (d) {
            return 'label-rect' + d.key;
          })
          .attr('x', function (d, i) {
            return xAlign + (i == 2 ? i * 328 : i * 220);
          })
          // .attr("y", function(d,i){ return 30 + i*(size+5)}) // 100 is where the first dot appears. 25 is the distance between dots
          .attr('y', yAlign)
          .attr('width', size)
          .attr('height', size/2)
          .attr('rx', 5)
          .attr('ry', 5)
          .style('fill', function (d) {
            return color(d.key);
          })
          .on('mouseover', highlight)
          .on('mouseleave', noHighlight);

        // Add text in the legend for each name.
        svg_legend
          .selectAll('mylabels')
          .data(key_focus)
          .enter()
          .append('text')
          .attr('class', function (d) {
            return 'text-legend label-' + d.key;
          })
          .attr('x', function (d, i) {
            return xAlign + size * 1.2 + (i == 2 ? i * 328 : i * 220);
          })
          .attr('y', yAlign + size / 4 + 2)
          .text(function (d) {
            return d.name + ' (' + d.key + ')';
          })
          .attr('text-anchor', 'left')
          .style('alignment-baseline', 'middle')
          .attr('cursor', 'default')
          .on('mouseover', highlight)
          .on('mouseleave', noHighlight);
      } //end function update()
    </script>
  </body>
</html>
